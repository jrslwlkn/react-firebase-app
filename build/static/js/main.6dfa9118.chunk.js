(this["webpackJsonpreact-firebase-app"]=this["webpackJsonpreact-firebase-app"]||[]).push([[0],{23:function(e,t,a){e.exports=a(40)},28:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(20),c=a(45),l=(a(28),a(43)),o=a(47),i=a(44),m=a(3),u=a.n(m),p=a(8),h=a(6),d=a(9),b=a.n(d);a(30),a(34),a(41);b.a.initializeApp({apiKey:"AIzaSyAW6A-d0RbqdqAFa-oRIrQ7m3GFhgzVxeU",authDomain:"react-firebase-app-a05a4.firebaseapp.com",databaseURL:"https://react-firebase-app-a05a4.firebaseio.com",projectId:"react-firebase-app-a05a4",storageBucket:"react-firebase-app-a05a4.appspot.com",messagingSenderId:"857620419922",appId:"1:857620419922:web:a188d33eebf6bad759168b",measurementId:"G-CBYJMGYKXE"}),window.firebase=b.a;const E=function(){var e=Object(h.a)(u.a.mark((function e(t,a){var n,s,r,c,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=v.doc("users/".concat(t.uid)),e.next=5,n.get();case 5:if(e.sent.exists){e.next=17;break}return s=new Date,r=t.displayName,c=t.email,l=t.photoURL,e.prev=9,e.next=12,n.set(Object(p.a)({displayName:r,email:c,photoURL:l,createdAt:s},a));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),console.warn(e.t0);case 17:return e.abrupt("return",f(t.uid));case 18:case"end":return e.stop()}}),e,null,[[9,14]])})));return function(t,a){return e.apply(this,arguments)}}(),f=function(){var e=Object(h.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.abrupt("return",v.collection("users").doc(t));case 6:e.prev=6,e.t0=e.catch(2),console.warn(e.t0);case 9:case"end":return e.stop()}}),e,null,[[2,6]])})));return function(t){return e.apply(this,arguments)}}(),v=b.a.firestore(),g=b.a.auth(),C=new b.a.auth.GoogleAuthProvider,y=b.a.storage(),N=()=>g.signInWithPopup(C).catch(console.warn),S=()=>g.signOut();b.a;var w=a(10),x=a.n(w);var U=e=>{const t=e.id,a=e.title,n=e.content,r=e.user,c=e.createdAt,o=e.stars,i=e.comments,m=g.currentUser,u=v.doc("posts/".concat(t));return s.a.createElement("article",{className:"Post"},s.a.createElement("div",{className:"Post--content"},s.a.createElement(l.a,{to:"posts/".concat(t)},s.a.createElement("h3",null,a)),s.a.createElement("div",null,n)),s.a.createElement("div",{className:"Post--meta"},s.a.createElement("div",null,s.a.createElement("p",null,s.a.createElement("span",{role:"img","aria-label":"star"},"\u2b50\ufe0f"),o),s.a.createElement("p",null,s.a.createElement("span",{role:"img","aria-label":"comments"},"\ud83d\ude4a"),i),s.a.createElement("p",null,"Posted by ",r.displayName),s.a.createElement("p",null,x()(c.toDate()).calendar())),(null===m||void 0===m?void 0:m.uid)&&s.a.createElement("div",{className:"Buttons"},s.a.createElement("button",{className:"star",onClick:()=>u.update({stars:o+1})},"Star"),m.uid===r.uid&&s.a.createElement("button",{className:"delete",onClick:()=>u.delete()},"Delete"))))};class D extends n.Component{constructor(...e){super(...e),this.state={title:"",content:""},this.handleChange=e=>{const t=e.target,a=t.name,n=t.value;this.setState({[a]:n})},this.handleSubmit=e=>{e.preventDefault();const t=this.state,a=t.title,n=t.content,s=g.currentUser,r={title:a,content:n,user:{uid:s.uid,displayName:s.displayName,email:s.email,photoURL:s.photoURL},favorites:0,comments:0,createdAt:new Date};console.log(r),v.collection("posts").add(r),this.setState({title:"",content:""})}}render(){const e=this.state,t=e.title,a=e.content;return s.a.createElement("form",{onSubmit:this.handleSubmit,className:"AddPost"},s.a.createElement("input",{type:"text",name:"title",placeholder:"Title",value:t,onChange:this.handleChange}),s.a.createElement("input",{type:"text",name:"content",placeholder:"Body",value:a,onChange:this.handleChange}),s.a.createElement("input",{className:"create",type:"submit",value:"Create Post"}))}}var k=D;const O=e=>Object(p.a)({id:e.id},e.data()),j=Object(n.createContext)();class P extends n.Component{constructor(...e){super(...e),this.state={posts:[]},this.firestoreUnsubscribe=null}componentDidMount(){this.firestoreUnsubscribe=v.collection("posts").onSnapshot(e=>{const t=e.docs.map(O);this.setState({posts:t})})}componentWillUnmount(){this.firestoreUnsubscribe()}render(){const e=this.state.posts,t=this.props.children;return s.a.createElement(j.Provider,{value:e},t)}}const R=Object(n.createContext)();class A extends n.Component{constructor(...e){super(...e),this.state={user:null},this.authUnsubscribe=null}componentDidMount(){var e=this;this.authUnsubscribe=g.onAuthStateChanged(function(){var t=Object(h.a)(u.a.mark((function t(a){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=5;break}return t.next=3,E(a);case 3:t.sent.onSnapshot(t=>{e.setState({user:Object(p.a)({uid:t.id},t.data())})});case 5:e.setState({user:a});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}componentWillUnmount(){this.authUnsubscribe()}render(){const e=this.state.user,t=this.props.children;return s.a.createElement(R.Provider,{value:e},t)}}var I=()=>{const e=Object(n.useContext)(j),t=Object(n.useContext)(R);return s.a.createElement("section",{className:"Posts"},(null===t||void 0===t?void 0:t.uid)&&s.a.createElement(k,null),e.map(e=>s.a.createElement(U,Object.assign({},e,{key:e.id}))))};var L=({displayName:e,photoURL:t,email:a,createdAt:n,children:r})=>s.a.createElement("section",{className:"UserProfile"},s.a.createElement("div",{className:"UserProfile--profile"},t&&s.a.createElement("img",{src:t,alt:e}),s.a.createElement("div",{className:"UserProfile--information"},s.a.createElement(l.a,{to:"profile"},s.a.createElement("h2",null,e)),s.a.createElement("p",{className:"email"},a),s.a.createElement("p",{className:"created-at"},x()(n?n.toDate():new Date).calendar()))),s.a.createElement("div",null,s.a.createElement("div",null,r),s.a.createElement("button",{onClick:S},"Sign Out")));class W extends n.Component{constructor(...e){super(...e),this.state={email:"",password:""},this.handleChange=e=>{const t=e.target,a=t.name,n=t.value;this.setState({[a]:n})},this.handleSubmit=e=>{e.preventDefault(),this.setState({email:"",password:""})}}render(){const e=this.state,t=e.email,a=e.password;return s.a.createElement("form",{className:"SignIn",onSubmit:this.handleSubmit},s.a.createElement("h2",null,"Sign In"),s.a.createElement("input",{type:"email",name:"email",placeholder:"Email",value:t,onChange:this.handleChange}),s.a.createElement("input",{type:"password",name:"password",placeholder:"Password",value:a,onChange:this.handleChange}),s.a.createElement("input",{type:"submit",value:"Sign In"}),s.a.createElement("button",{onClick:N},"Sign In With Google"))}}var B=W;class G extends n.Component{constructor(...e){var t;super(...e),t=this,this.state={displayName:"",email:"",password:""},this.handleChange=e=>{const t=e.target,a=t.name,n=t.value;this.setState({[a]:n})},this.handleSubmit=function(){var e=Object(h.a)(u.a.mark((function e(a){var n,s,r,c,l,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),n=t.state,s=n.displayName,r=n.email,c=n.password,e.prev=2,e.next=5,g.createUserWithEmailAndPassword(r,c);case 5:l=e.sent,o=l.user,E(o,{displayName:s}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.warn(e.t0);case 13:t.setState({displayName:"",email:"",password:""});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}()}render(){const e=this.state,t=e.displayName,a=e.email,n=e.password;return s.a.createElement("form",{className:"SignUp",onSubmit:this.handleSubmit},s.a.createElement("h2",null,"Sign Up"),s.a.createElement("input",{type:"text",name:"displayName",placeholder:"Display Name",value:t,onChange:this.handleChange}),s.a.createElement("input",{type:"email",name:"email",placeholder:"Email",value:a,onChange:this.handleChange}),s.a.createElement("input",{type:"password",name:"password",placeholder:"Password",value:n,onChange:this.handleChange}),s.a.createElement("input",{type:"submit",value:"Sign Up",disabled:!t||!a||!n}))}}var F=G;function M(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(B,null),s.a.createElement(F,null))}function z(){const e=Object(n.useContext)(R);return s.a.createElement("div",null,e?s.a.createElement(L,e):s.a.createElement(M,null))}class J extends n.Component{constructor(...e){super(...e),this.state={displayName:""},this.image=null,this.handleChange=e=>{const t=e.target,a=t.name,n=t.value;this.setState({[a]:n})},this.handleSubmit=e=>{e.preventDefault();const t=this.state.displayName;t&&(this.userRef.update({displayName:t}),this.setState({displayName:""})),this.file&&y.ref().child("user-profiles").child(this.uid).child(this.file.name).put(this.file).then(e=>e.ref.getDownloadURL()).then(e=>this.userRef.update({photoURL:e}))}}get uid(){return g.currentUser.uid}get userRef(){return v.doc("users/".concat(this.uid))}get file(){return this.image&&this.image.files[0]}render(){const e=this.state.displayName;return s.a.createElement("section",{className:"UserProfile"},s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("input",{type:"text",placeholder:"Display Name",value:e,name:"displayName",onChange:this.handleChange}),s.a.createElement("input",{type:"file",ref:e=>this.image=e}),s.a.createElement("input",{type:"submit",className:"create"})))}}var q=({content:e,user:t,createdAt:a})=>s.a.createElement("article",{className:"Comment"},s.a.createElement("span",{className:"Comment--author"},t.displayName),s.a.createElement("span",{className:"Comment--content"},e),s.a.createElement("span",{className:"Comment--timestamp"},x()(t.createdAt.toDate()).calendar()));class K extends n.Component{constructor(...e){super(...e),this.state={content:""},this.handleChange=e=>{const t=e.target,a=t.name,n=t.value;this.setState({[a]:n})},this.handleSubmit=e=>{e.preventDefault(),this.props.onCreate(this.state),this.setState({content:""})}}render(){const e=this.state.content;return s.a.createElement("form",{onSubmit:this.handleSubmit,className:"AddComment"},s.a.createElement("input",{type:"text",name:"content",placeholder:"Comment",value:e,onChange:this.handleChange}),s.a.createElement("input",{className:"create",type:"submit",value:"Create Comment"}))}}var T=K;var Y=({comments:e,onCreate:t})=>s.a.createElement("section",{className:"Comments"},s.a.createElement(T,{onCreate:t}),e.map(e=>s.a.createElement(q,Object.assign({},e,{key:e.id})))),Q=a(46);class V extends n.Component{constructor(...e){var t;super(...e),t=this,this.state={post:null,comments:[]},this.postUnsubscribe=null,this.commentsUnsubscribe=null,this.componentDidMount=Object(h.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.postUnsubscribe=t.postRef.onSnapshot(e=>{const a=O(e);t.setState({post:a})}),t.commentsUnsubscribe=t.commentsRef.onSnapshot(e=>{const a=e.docs.map(O);t.setState({comments:a})});case 2:case"end":return e.stop()}}),e)}))),this.createComment=e=>{const t=this.props.user;this.commentsRef.add(Object(p.a)({},e,{user:t}))}}get postID(){return this.props.match.params.id}get postRef(){return v.doc("posts/".concat(this.postID))}get commentsRef(){return this.postRef.collection("comments")}componentWillUnmount(){this.postUnsubscribe(),this.commentsUnsubscribe()}render(){const e=this.state,t=e.post,a=e.comments;return s.a.createElement("section",null,t&&s.a.createElement(s.a.Fragment,null,s.a.createElement(U,t),s.a.createElement(Y,{comments:a,postID:t.id,onCreate:this.createComment})))}}var X=Object(Q.a)(function(e){const t=t=>s.a.createElement(R.Consumer,null,a=>s.a.createElement(e,Object.assign({user:a},t)));return t.displayName="withUser(".concat((e=>e.getDisplayName||e.name||"Component")(t),")"),t}(V));Object(r.render)(s.a.createElement(c.a,null,s.a.createElement(A,null,s.a.createElement(P,null,s.a.createElement((function(){return s.a.createElement("main",{className:"Application"},s.a.createElement(l.a,{to:"/"},s.a.createElement("h1",null,"Think Piece")),s.a.createElement(z,null),s.a.createElement(o.a,null,s.a.createElement(i.a,{exact:!0,path:"/",component:I}),s.a.createElement(i.a,{exact:!0,path:"/profile",component:J}),s.a.createElement(i.a,{exact:!0,path:"/posts/:id",component:X})))}),null)))),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.6dfa9118.chunk.js.map